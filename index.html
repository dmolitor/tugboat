<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Build a Docker Image from a Directory or Project • tugboat</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Build a Docker Image from a Directory or Project">
<meta name="description" content="Simple utilities to generate a Dockerfile from a directory or project, build the corresponding Docker image, and push the image to DockerHub.">
<meta property="og:description" content="Simple utilities to generate a Dockerfile from a directory or project, build the corresponding Docker image, and push the image to DockerHub.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">tugboat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="tugboat">tugboat<a class="anchor" aria-label="anchor" href="#tugboat"></a>
</h1></div>
<p>A simple R package to generate a Dockerfile and corresponding Docker image from an analysis directory. tugboat uses the <a href="https://github.com/rstudio/renv" class="external-link">renv</a> package to automatically detect all the packages necessary to replicate your analysis and will generate a Dockerfile that contains an exact copy of your entire directory with all the packages installed.</p>
<p>tugboat builds directly on the <a href="https://github.com/ThinkR-open/dockerfiler" class="external-link">dockerfiler</a> package which generates Dockerfiles from DESCRIPTION files or from <code>renv.lock</code> files. tugboat adds the sugar of converting an unstructured analysis folder into the necessary <code>renv.lock</code> file and then relies on dockerfiler to do the rest.</p>
<p>tugboat may be of use, for example, when preparing a replication package for research. With tugboat, you can take a directory on your local computer and quickly generate a Dockerfile and Docker image that contains all the code and the necessary software to reproduce your findings.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install tugboat with</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"dmolitor/tugboat"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>tugboat only has two exported functions; one to create a Dockerfile from your analysis directory, and one to build the corresponding Docker image.</p>
<div class="section level3">
<h3 id="create-the-dockerfile">Create the Dockerfile<a class="anchor" aria-label="anchor" href="#create-the-dockerfile"></a>
</h3>
<p>The primary function from tugboat is <code>create</code>. This function will turn your analysis directory into a Dockerfile that includes all your code and essential R packages. For the most common cases, there are a couple arguments in this function that are of particular importance:</p>
<ul>
<li>
<code>project</code>: This argument tells tugboat which directory is the one to generate the Dockerfile from. You can set this value yourself, or you can just use the default value. By default, tugboat uses the <code><a href="https://here.r-lib.org//reference/here.html" class="external-link">here::here</a></code> function to determine what directory is the project directory. To get a detailed understanding of exactly how this works take a look at the <a href="https://github.com/r-lib/here" class="external-link">here package</a> but in general, this “just works”!</li>
<li>
<code>as</code>: This argument tells tugboat where to save the Dockerfile. In general you don’t need to set this and tugboat will just save the Dockerfile in the <code>project</code> directory from above.</li>
<li>
<code>exclude</code>: A vector of files or directories that should <strong><em>NOT</em></strong> be included in the Docker image. This is particularly important when you have, for example, large data directories that you plan to mount to a container instead of including them in the Docker image.</li>
</ul>
<p>Below I’ll outline a couple examples.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.dmolitor.com/tugboat/">tugboat</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The simplest scenario where your analysis directory is your current</span></span>
<span><span class="co"># active project, you are fine with the default base "rocker/r-base"</span></span>
<span><span class="co"># Docker image, and you want to include all files/directories:</span></span>
<span><span class="fu"><a href="reference/create.html">create</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Suppose your analysis directory is actually a sub-directory of your</span></span>
<span><span class="co"># main project directory:</span></span>
<span><span class="fu"><a href="reference/create.html">create</a></span><span class="op">(</span>project <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"sub-directory"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Suppose that you specifically need a Docker base image that has RStudio</span></span>
<span><span class="co"># installed so that you can interact with your analysis within a Docker </span></span>
<span><span class="co"># container. To do this, we will pass additional arguments directly to the</span></span>
<span><span class="co"># `dockerfiler::dock_from_renv function.</span></span>
<span><span class="fu"><a href="reference/create.html">create</a></span><span class="op">(</span>FROM <span class="op">=</span> <span class="st">"rocker/rstudio"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Finally, suppose that we want to include all files except a couple</span></span>
<span><span class="co"># particularly data-heavy sub-directories:</span></span>
<span><span class="fu"><a href="reference/create.html">create</a></span><span class="op">(</span>exclue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"data/big_directory_1"</span>, <span class="st">"data/big_directory_2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="build-the-docker-image">Build the Docker image<a class="anchor" aria-label="anchor" href="#build-the-docker-image"></a>
</h3>
<p>Once the Dockerfile has been created, we can build the Docker image. By default this will infer the Dockerfile directory using <code><a href="https://here.r-lib.org//reference/here.html" class="external-link">here::here</a></code>. This function assumes a little knowledge about Docker; if you aren’t sure where to start, <a href="https://colinfay.me/docker-r-reproducibility/" class="external-link">this is a great starting point</a>.</p>
<p>The following example will do the simplest thing and will build the image locally.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/build.html">build</a></span><span class="op">(</span>image_name <span class="op">=</span> <span class="st">"awesome_analysis"</span><span class="op">)</span></span></code></pre></div>
<p>Suppose that, like above, your analysis directory is a sub-directory of your main project directory:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/build.html">build</a></span><span class="op">(</span></span>
<span>  dockerfile <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"sub-directory"</span><span class="op">)</span>,</span>
<span>  image_name <span class="op">=</span> <span class="st">"awesome_analysis"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="push-to-dockerhub">Push to DockerHub<a class="anchor" aria-label="anchor" href="#push-to-dockerhub"></a>
</h3>
<p>If, instead of just building the Docker image locally, you want to build the image and then push to DockerHub, you can make a couple small additions to the code above:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/build.html">build</a></span><span class="op">(</span></span>
<span>  image_name <span class="op">=</span> <span class="st">"awesome_analysis"</span>,</span>
<span>  push <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dh_username <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"DH_USERNAME"</span><span class="op">)</span>,</span>
<span>  dh_password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"DH_PASSWORD"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note: If you choose to push, you also need to provide your DockerHub username and password. Typically you don’t want to pass these in directly and should instead use environment variables (or a similar method) instead.</p>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>For some worked examples of how to use tugboat in practice, see the <code>examples/</code> directory.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tugboat</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Daniel Molitor <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Molitor.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
