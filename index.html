<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Build a Docker Image from a Directory or Project • tugboat</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Build a Docker Image from a Directory or Project">
<meta name="description" content="Simple utilities to generate a Dockerfile from a directory or project, build the corresponding Docker image, push the image to DockerHub, and publicly share the project via Binder.">
<meta property="og:description" content="Simple utilities to generate a Dockerfile from a directory or project, build the corresponding Docker image, push the image to DockerHub, and publicly share the project via Binder.">
<meta property="og:image" content="https://dmolitor.com/tugboat/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">tugboat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="tugboat-">tugboat <a class="anchor" aria-label="anchor" href="#tugboat-"></a>
</h1>
</div>
<!-- badges: start -->

<p>A simple R package to generate a Dockerfile and corresponding Docker image from an analysis directory. tugboat also prepares your analysis directory to be shared via <a href="https://mybinder.readthedocs.io/en/latest/index.html" class="external-link">Binder</a>.</p>
<p>tugboat uses the <a href="https://github.com/rstudio/renv/" class="external-link">renv</a> package to automatically detect all the packages necessary to replicate your analysis and will generate a Dockerfile that contains an exact copy of your entire directory with all the packages installed. tugboat transforms an unstructured analysis folder into a renv.lock file and constructs a Docker image that includes all your essential R packages based on this lockfile.</p>
<p>tugboat may be of use, for example, when preparing a replication package for research. With tugboat, you can take a directory on your local computer and quickly generate a corresponding Dockerfile and Docker image that contains all the code and the necessary software to reproduce your findings.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install tugboat from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tugboat"</span><span class="op">)</span></span></code></pre></div>
<p>Or install the development version from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"dmolitor/tugboat"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>tugboat only has three exported functions; one to create a Dockerfile from your analysis directory, one to build the corresponding Docker image, and one to make your project ready to share and run in an online, interactive compute environment via <a href="https://mybinder.readthedocs.io/en/latest/index.html" class="external-link">Binder</a>.</p>
<div class="section level3">
<h3 id="create-the-dockerfile">Create the Dockerfile<a class="anchor" aria-label="anchor" href="#create-the-dockerfile"></a>
</h3>
<p>The primary function from tugboat is <code><a href="reference/create.html">create()</a></code>. This function converts your analysis directory into a Dockerfile that includes all your code and essential R packages.</p>
<p>This function scans all files in the current analysis directory, attempts to detect all R packages, and installs these packages in the resulting Docker image. It also copies the entire contents of the analysis directory into the Docker image. For example, if your analysis directory is named <code>incredible_analysis</code>, the corresponding location of your code and data files in the generated Docker image will be <code>/incredible_analysis</code>.</p>
<p>For the most common use-cases, there are a couple of arguments in this function that are particularly important:</p>
<ul>
<li>
<code>project</code>: This argument tells tugboat which directory is the one to generate the Dockerfile from. You can set this value yourself, or you can just use the default value. By default, tugboat uses the <code><a href="https://here.r-lib.org/reference/here.html" class="external-link">here::here</a></code> function to determine what directory is the analysis directory. To get a detailed understanding of exactly how this works take a look at the <a href="https://github.com/r-lib/here/" class="external-link">here package</a>. In general, this “just works”!</li>
<li>
<code>as</code>: This argument tells tugboat where to save the Dockerfile. In general you don’t need to set this and tugboat will just save the Dockerfile in the <code>project</code> directory from above.</li>
<li>
<code>exclude</code>: A vector of files or sub-directories in your analysis directory that should <strong><em>NOT</em></strong> be included in the Docker image. This is particularly important when you have, for example, a sub-directory with large data files that would make the resulting Docker image extremely large if included. You can tell tugboat to exclude this sub-directory and then simply mount it to a Docker container as needed.</li>
</ul>
<p>Below I’ll outline a couple examples.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.dmolitor.com/tugboat/" class="external-link">tugboat</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The simplest scenario where your analysis directory is your current</span></span>
<span><span class="co"># active project, you are fine with the default base "r-base:latest"</span></span>
<span><span class="co"># Docker image, and you want to include all files/directories:</span></span>
<span><span class="fu"><a href="reference/create.html">create</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Suppose your analysis directory is actually a sub-directory of your</span></span>
<span><span class="co"># main project directory:</span></span>
<span><span class="fu"><a href="reference/create.html">create</a></span><span class="op">(</span>project <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"sub-directory"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Suppose that you specifically need a Docker base image that has RStudio</span></span>
<span><span class="co"># installed so that you can interact with your analysis within a Docker </span></span>
<span><span class="co"># container. To do this, we will explicitly specify a different Docker</span></span>
<span><span class="co"># base image using the `FROM` argument.</span></span>
<span><span class="fu"><a href="reference/create.html">create</a></span><span class="op">(</span>FROM <span class="op">=</span> <span class="st">"rocker/rstudio"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Finally, suppose that we want to include all files except a couple</span></span>
<span><span class="co"># particularly data-heavy sub-directories:</span></span>
<span><span class="fu"><a href="reference/create.html">create</a></span><span class="op">(</span>exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"data/big_directory_1"</span>, <span class="st">"data/big_directory_2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="build-the-docker-image">Build the Docker image<a class="anchor" aria-label="anchor" href="#build-the-docker-image"></a>
</h3>
<p>Once the Dockerfile has been created, we can build the Docker image with the <code><a href="reference/build.html">build()</a></code> function. By default this will infer the Dockerfile directory using <code><a href="https://here.r-lib.org/reference/here.html" class="external-link">here::here</a></code>. This function assumes a little knowledge about Docker; if you aren’t sure where to start, <a href="https://colinfay.me/docker-r-reproducibility/" class="external-link">this is a great starting point</a>.</p>
<p>The following example will do the simplest thing and will build the image locally.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/build.html">build</a></span><span class="op">(</span>image_name <span class="op">=</span> <span class="st">"awesome_analysis"</span><span class="op">)</span></span></code></pre></div>
<p>Suppose that, like above, your analysis directory is a sub-directory of your main project directory:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/build.html">build</a></span><span class="op">(</span></span>
<span>  dockerfile <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"sub-directory"</span><span class="op">)</span>,</span>
<span>  image_name <span class="op">=</span> <span class="st">"awesome_analysis"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="push-to-dockerhub">Push to DockerHub<a class="anchor" aria-label="anchor" href="#push-to-dockerhub"></a>
</h3>
<p>If, instead of just building the Docker image locally, you want to build the image and then push to DockerHub, you can make a couple small additions to the code above:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/build.html">build</a></span><span class="op">(</span></span>
<span>  image_name <span class="op">=</span> <span class="st">"awesome_analysis"</span>,</span>
<span>  push <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dh_username <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"DH_USERNAME"</span><span class="op">)</span>,</span>
<span>  dh_password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"DH_PASSWORD"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note: If you choose to push, you also need to provide your DockerHub username and password. Typically you don’t want to pass these in directly and should instead use environment variables (or a similar method) instead.</p>
</div>
<div class="section level3">
<h3 id="share-your-project-via-binder">Share your project via Binder<a class="anchor" aria-label="anchor" href="#share-your-project-via-binder"></a>
</h3>
<p>Binder lets others instantly launch and interact with your R project in a live, cloud-based environment with no local setup required. tugboat will prepare your project to be shared with Binder. The process is simple:</p>
<ul>
<li>
<p>First, create the Dockerfile from your analysis directory:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/create.html">create</a></span><span class="op">(</span></span>
<span>  project <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"data/big_directory_1"</span>, <span class="st">"data/big_directory_2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>Then, prep your directory for Binder. Your analysis directory <em>must</em> be a GitHub repository:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/binderize.html">binderize</a></span><span class="op">(</span>branch <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></span></code></pre></div>
<p>By default this will add a Binder badge to your README.Rmd or README.md file. If your README file already has a section for badges, it will add the new badge automatically:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>✔ Adding <span class="st">"Launch RStudio Binder badge"</span> to README.md.</span></code></pre></div>
<p>If your README file does <em>not</em> have a section for badges, it will automatically save the badge to your clipboard and you will need to manually insert it into the README.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>☐ Copy and paste the following lines into README.md<span class="sc">:</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="er">&lt;</span><span class="sc">!--</span> badges<span class="sc">:</span> start <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  [<span class="sc">!</span>[Launch RStudio Binder](https<span class="sc">:</span><span class="er">//</span>mybinder.org<span class="sc">/</span>badge_logo.svg)](https<span class="sc">:</span><span class="er">//</span>mybinder.org<span class="sc">/</span>v2<span class="sc">/</span>gh<span class="sc">/</span>{username}<span class="sc">/</span>{repo}<span class="sc">/</span>{branch}?<span class="at">urlpath=</span>rstudio)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="sc">&lt;!--</span> badges<span class="sc">:</span> end <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  [Copied to clipboard]</span></code></pre></div>
</li>
</ul>
<p>After running <code><a href="reference/binderize.html">binderize()</a></code> you will see the following message:</p>
<pre><code>Your repository has been configured for Binder.
[x] Commit and push all changes
[x] Launch Binder at: https://mybinder.org/v2/gh/{username}/{repo}/{branch}?urlpath=rstudio</code></pre>
<p>You must commit and push all changes <em>before</em> visiting the Binder link, otherwise it will likely fail. Binder can automatically detect changes to the repository and will rebuild as necessary, ensuring that the Binder repository stays up to date.</p>
</div>
</div>
<div class="section level2">
<h2 id="why-tugboat-">Why tugboat? 🚢<a class="anchor" aria-label="anchor" href="#why-tugboat-"></a>
</h2>
<p>There are a few available packages with similar goals, so why tugboat? tugboat is minimal and builds directly on top of <a href="https://rstudio.github.io/renv/articles/renv.html" class="external-link"><code>renv</code></a> and <a href="https://pak.r-lib.org/" class="external-link"><code>pak</code></a>. Each of these packages is actively maintained and provides specific utilities that the tugboat utilizes for maximum convenience. tugboat aims to leverage packages that are likely to remain actively maintained and handle dependency management as seamlessly as possible.</p>
<ul>
<li><p><a href="https://o2r.info/containerit/" class="external-link">containerit</a> is a robust package that is directly comparable to tugboat. However, it implements its own method for discovering R package dependencies instead of using renv. It also relies on <a href="https://github.com/r-hub/sysreqsdb" class="external-link">sysreqsdb</a> for system dependency discovery, which has been archived in favor of <a href="https://github.com/rstudio/r-system-requirements" class="external-link">r-system-requirements</a>, which pak is built on. It also isn’t super actively maintained and isn’t on CRAN.</p></li>
<li><p><a href="https://github.com/karthik/holepunch" class="external-link">holepunch</a> is related but focuses on making GitHub repositories Binder-compatible. It currently relies on MRAN, which is now obsolete, and does not use pak for system dependency management. It is also not actively maintained and is not on CRAN.</p></li>
<li><p><a href="https://github.com/cole-brokamp/automagic" class="external-link">automagic</a> focuses on automatically detecting and installing R package dependencies but uses its own method rather than relying on renv. automagic also has no utilities for creating/building Docker images.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>For some worked examples of how to use tugboat in practice, see the <code>examples/</code> directory.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=tugboat" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tugboat</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Daniel Molitor <br><small class="roles"> Author, copyright holder, maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/dmolitor/tugboat/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/dmolitor/tugboat/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://github.com/dmolitor/tugboat/actions/workflows/pkgdown.yaml" class="external-link"><img src="https://github.com/dmolitor/tugboat/actions/workflows/pkgdown.yaml/badge.svg" alt="pkgdown"></a></li>
<li><a href="https://CRAN.R-project.org/package=tugboat" class="external-link"><img src="https://www.r-pkg.org/badges/version/tugboat" alt="CRAN status"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Molitor.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
